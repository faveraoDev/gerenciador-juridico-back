openapi: 3.0.3
info:
  title: API - Gerenciador Jurídico
  version: 1.0.0
  description: |
    Documentação da API do Gerenciador Jurídico.
    Todas as rotas (exceto `/api/usuarios/login` e `/api/usuarios`) exigem autenticação JWT via header `Authorization: Bearer <token>`.

servers:
  - url: http://localhost:4000
    description: Servidor local de desenvolvimento
  - url: https://gerenciador-juridico-back.onrender.com
    description: Servidor hospedado (Render)

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    Usuario:
      type: object
      properties:
        ID_usuario:
          type: string
        NOME_usuario:
          type: string
        EMAIL_usuario:
          type: string
        SENHA_usuario:
          type: string
      required: [NOME_usuario, EMAIL_usuario, SENHA_usuario]

    Cliente:
      type: object
      properties:
        ID_cliente:
          type: string
        NOME_cliente:
          type: string
        RG_cliente:
          type: string
        CPF_cliente:
          type: string
        DTNSC_cliente:
          type: string
          format: date
        EMAIL_cliente:
          type: string
        TEL_cliente:
          type: string
        OCUPACAO_cliente:
          type: string
        JUSTGRAT_cliente:
          type: boolean
        NMREND_cliente:
          type: string
        COMPL_cliente:
          type: string
        Enderecos_ID_endereco:
          type: string
      required: [NOME_cliente, CPF_cliente, EMAIL_cliente, TEL_cliente, Enderecos_ID_endereco]

    Advogado:
      type: object
      properties:
        ID_advogado:
          type: string
        NOME_advogado:
          type: string
        CPF_advogado:
          type: string
        OAB_advogado:
          type: string
        DTNSC_advogado:
          type: string
          format: date
        TEL_advogado:
          type: string
        EMAIL_advogado:
          type: string
        STATUS_advogado:
          type: boolean
      required: [NOME_advogado, CPF_advogado, OAB_advogado, STATUS_advogado]

    Endereco:
      type: object
      properties:
        ID_endereco:
          type: string
        CEP_endereco:
          type: string
        LGDR_endereco:
          type: string
        NOME_endereco:
          type: string
        UF_endereco:
          type: string
        BAIRRO_endereco:
          type: string
        CIDADE_endereco:
          type: string
      required: [CEP_endereco, LGDR_endereco, NOME_endereco, UF_endereco, BAIRRO_endereco, CIDADE_endereco]

    Processo:
      type: object
      properties:
        ID_processo:
          type: string
        NUMERO_processo:
          type: string
        STATUS_processo:
          type: string
        DATAINICIO_processo:
          type: string
          format: date
        locais_ID_local:
          type: string
      required: [NUMERO_processo, STATUS_processo, DATAINICIO_processo, locais_ID_local]

    Documento:
      type: object
      properties:
        ID_documento:
          type: string
        TIPO_documento:
          type: string
        DATA_documento:
          type: string
          format: date
        DESC_documento:
          type: string
      required: [TIPO_documento, DATA_documento, DESC_documento]

    Locais:
      type: object
      properties:
        ID_local:
          type: string
        NOME_local:
          type: string
      required: [NOME_local]

security:
  - bearerAuth: []

paths:
  /api/usuarios/register:
    post:
      summary: Cria um novo usuário
      tags: [Usuários]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                email:
                  type: string
                senha:
                  type: string
      responses:
        '201':
          description: Usuário criado com sucesso
        '400':
          description: Erro na criação do usuário - Não preencheu todos os campos ou email já existe

  /api/usuarios/login:
    post:
      summary: Realiza login e retorna um token JWT
      tags: [Usuários]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                senha:
                  type: string
      responses:
        '200':
          description: Login bem-sucedido com token JWT
        '400':
          description: Usuário não encontrado
        '401':
          description: Senha incorreta

  /api/usuarios/trocar-senha:
    patch:
      summary: Permite ao usuário AUTENTICADO trocar sua senha
      tags: [Usuários]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                senhaAtual:
                  type: string
                senhaNova:
                  type: string
      responses:
        '200':
          description: Senha alterada com sucesso
        '400':
          description: Erro na alteração da senha - campos faltando, nova senha muito curta ou nova senha igual à atual
        '401':
          description: Senha atual incorreta ou token inválido
        '404':
          description: Usuário não encontrado

  /api/clientes:
    get:
      summary: Lista todos os clientes
      tags: [Clientes]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de clientes retornada com sucesso
    post:
      summary: Cria um novo cliente (com endereço opcional)
      tags: [Clientes]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                rg:
                  type: string
                cpf:
                  type: string
                dtnsc:
                  type: string
                  format: date
                email:
                  type: string
                tel:
                  type: string
                ocupacao:
                  type: string
                justgrat:
                  type: boolean
                nmrend:
                  type: string
                compl:
                  type: string
                endereco:
                  type: object
                  properties:
                    cep:
                      type: string
                    lgdr:
                      type: string
                    nome:
                      type: string
                    uf:
                      type: string
                    bairro:
                      type: string
                    cidade:
                      type: string
      responses:
        '201':
          description: Cliente criado com sucesso
        '400':
          description: Erro na criação do cliente

  /api/clientes/{id}:
    get:
      summary: Busca um cliente por ID
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Cliente encontrado
    put:
      summary: Atualiza os dados de um cliente
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                rg:
                  type: string
                cpf:
                  type: string
                dtnsc:
                  type: string
                  format: date
                email:
                  type: string
                tel:
                  type: string
                ocupacao:
                  type: string
                justgrat:
                  type: boolean
                nmrend:
                  type: string
                compl:
                  type: string
                endereco:
                  type: object
                  properties:
                    cep:
                      type: string
                    lgdr:
                      type: string
                    nome:
                      type: string
                    uf:
                      type: string
                    bairro:
                      type: string
                    cidade:
                      type: string
      responses:
        '200':
          description: Cliente atualizado

    patch:
      summary: Atualiza parcialmente os dados de um cliente (por exemplo, email ou telefone)
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $type: object
              properties:
                nome:
                  type: string
                rg:
                  type: string
                cpf:
                  type: string
                dtnsc:
                  type: string
                  format: date
                email:
                  type: string
                tel:
                  type: string
                ocupacao:
                  type: string
                justgrat:
                  type: boolean
                nmrend:
                  type: string
                compl:
                  type: string
                endereco:
                  type: object
                  properties:
                    cep:
                      type: string
                    lgdr:
                      type: string
                    nome:
                      type: string
                    uf:
                      type: string
                    bairro:
                      type: string
                    cidade:
                      type: string
      responses:
        '200':
          description: Cliente atualizado parcialmente

    delete:
      summary: Exclui um cliente
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Cliente removido

  /api/advogados:
    get:
      summary: Lista todos os advogados
      tags: [Advogados]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de advogados
    post:
      summary: Cria um novo advogado
      tags: [Advogados]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                cpf:
                  type: string
                oab:
                  type: string
                dtnsc:
                  type: string
                  format: date
                tel:
                  type: string
                email:
                  type: string
      responses:
        '201':
          description: Advogado criado com sucesso
        '400':
          description: Erro na criação do advogado

  /api/advogados/{id}:
    get:
      summary: Busca advogado por ID
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Advogado encontrado

    put:
      summary: Atualiza um advogado
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:      
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                cpf:
                  type: string
                oab:
                  type: string
                dtnsc:
                  type: string
                  format: date
                tel:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: Advogado atualizado
        '400':
          description: Erro na atualização do advogado

    patch:
      summary: Atualiza parcialmente o advogado (por exemplo, status)
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                cpf:
                  type: string
                oab:
                  type: string
                dtnsc:
                  type: string
                  format: date
                tel:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: Advogado atualizado
    delete:
      summary: Remove um advogado
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Advogado excluído

  /api/enderecos:
    get:
      summary: Lista todos os endereços
      tags: [Endereços]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de endereços
    post:
      summary: Cria um novo endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                cep:
                  type: string
                lgdr:
                  type: string
                nome:
                  type: string
                uf:
                  type: string
                bairro:
                  type: string
                cidade:
                  type: string
      responses:
        '201':
          description: Endereço criado
        '400':
          description: Erro na criação do endereço

  /api/enderecos/{id}:
    get:
      summary: Busca um endereço por ID
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Endereço encontrado
        '404':
          description: Endereço não encontrado
    put:
      summary: Atualiza um endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                cep:
                  type: string
                lgdr:
                  type: string
                nome:
                  type: string
                uf:
                  type: string
                bairro:
                  type: string
                cidade:
                  type: string
      responses:
        '200':
          description: Endereço atualizado
        '400':
          description: Erro na atualização do endereço

    patch:
      summary: Atualiza parcialmente um endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                cep:
                  type: string
                lgdr:
                  type: string
                nome:
                  type: string
                uf:
                  type: string
                bairro:
                  type: string
                cidade:
                  type: string
      responses:
        '200':
          description: Endereço atualizado
        '400':
          description: Erro na atualização do endereço

    delete:
      summary: Exclui um endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Endereço removido
        '400':
          description: Erro na remoção do endereço

  /api/processos:
    get:
      summary: Lista todos os processos
      tags: [Processos]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de processos
    post:
      summary: Cria um novo processo
      tags: [Processos]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                numeroProcesso:
                  type: string
                datainicio:
                  type: string
                  format: date
                cpfCliente:
                  type: string
                oabAdvogado:
                  type: string
                status:
                  type: string
                nomeLocal:
                  type: string
      responses:
        '201':
          description: Processo criado
        '400':
          description: Erro na criação do processo
        '404':
          description: Cliente, Advogado ou Local não encontrado
        '501':
          description: Erro interno do servidor ao criar o processo

  /api/processos/{id}:
    get:
      summary: Busca processo por ID
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Processo encontrado
        '404':
          description: Processo não encontrado
    put:
      summary: Atualiza um processo
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                numeroProcesso:
                  type: string
                datainicio:
                  type: string
                  format: date
                cpfCliente:
                  type: string
                oabAdvogado:
                  type: string
                status:
                  type: string
                nomeLocal:
                  type: string
      responses:
        '200':
          description: Processo atualizado
        '400':
          description: Erro na atualização do processo

    patch:
      summary: Atualiza parcialmente um processo
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                numeroProcesso:
                  type: string
                datainicio:
                  type: string
                  format: date
                cpfCliente:
                  type: string
                oabAdvogado:
                  type: string
                status:
                  type: string
                nomeLocal:
                  type: string
      responses:
        '200':
          description: Processo atualizado
        '400':
          description: Erro na atualização do processo
        
    delete:
      summary: Exclui um processo
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Processo removido
        '400':
          description: Erro na remoção do processo

  /api/locais:
    get:
      summary: Lista todos os locais
      tags: [Locais]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de locais
    post:
      summary: Cria um novo local
      tags: [Locais]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
      responses:
        '201':
          description: Local criado
        '400':
          description: Erro na criação do local

  /api/locais/{id}:
    get:
      summary: Busca local por ID
      tags: [Locais]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Local encontrado
        '404':
          description: Local não encontrado
    put:
      summary: Atualiza um local
      tags: [Locais]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: 
                nome:
                  type: string
      responses:
        '200':
          description: Local atualizado
        '400':
          description: Erro na atualização do local

    patch:
      summary: Atualiza parcialmente um local
      tags: [Locais]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: 
                nome:
                  type: string
      responses:
        '200':
          description: Local atualizado
        '400':
          description: Erro na atualização do local

    delete:
      summary: Exclui um local
      tags: [Locais]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Local removido
        '400':
          description: Erro na remoção do local