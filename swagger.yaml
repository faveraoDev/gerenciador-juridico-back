openapi: 3.0.3
info:
  title: API - Gerenciador Jurídico
  version: 1.0.0
  description: |
    Documentação da API do Gerenciador Jurídico.
    Todas as rotas (exceto `/api/usuarios/login` e `/api/usuarios`) exigem autenticação JWT via header `Authorization: Bearer <token>`.

servers:
  - url: http://localhost:4000
    description: Servidor local de desenvolvimento
  - url: https://gerenciador-juridico-back.onrender.com
    description: Servidor hospedado (Render)

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    Usuario:
      type: object
      properties:
        ID_usuario:
          type: string
        EMAIL_usuario:
          type: string
        SENHA_usuario:
          type: string
      required: [EMAIL_usuario, SENHA_usuario]

    Cliente:
      type: object
      properties:
        ID_cliente:
          type: string
        NOME_cliente:
          type: string
        RG_cliente:
          type: string
        CPF_cliente:
          type: string
        DTNSC_cliente:
          type: string
          format: date
        EMAIL_cliente:
          type: string
        TEL_cliente:
          type: string
        OCUPACAO_cliente:
          type: string
        JUSTGRAT_cliente:
          type: boolean
        NMREND_cliente:
          type: string
      required: [NOME_cliente, CPF_cliente]

    Advogado:
      type: object
      properties:
        ID_advogado:
          type: string
        NOME_advogado:
          type: string
        OAB_advogado:
          type: string
        EMAIL_advogado:
          type: string
        STATUS_advogado:
          type: boolean
      required: [NOME_advogado, OAB_advogado]

    Endereco:
      type: object
      properties:
        ID_endereco:
          type: string
        RUA:
          type: string
        BAIRRO:
          type: string
        CIDADE:
          type: string
        ESTADO:
          type: string

    Processo:
      type: object
      properties:
        ID_processo:
          type: string
        NUMERO_processo:
          type: string
        TIPO_processo:
          type: string
        STATUS_processo:
          type: string

security:
  - bearerAuth: []

paths:
  /api/usuarios/register:
    post:
      summary: Cria um novo usuário
      tags: [Usuários]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Usuario'
      responses:
        '201':
          description: Usuário criado com sucesso
        '400':
          description: Erro na criação do usuário - Não preencheu todos os campos ou email já existe

  /api/usuarios/login:
    post:
      summary: Realiza login e retorna um token JWT
      tags: [Usuários]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                senha:
                  type: string
      responses:
        '200':
          description: Login bem-sucedido com token JWT
        '400':
          description: Usuário não encontrado
        '401':
          description: Senha incorreta

  /api/trocar-senha:
    patch:
      summary: Permite ao usuário AUTENTICADO trocar sua senha
      tags: [Usuários]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                senhaAtual:
                  type: string
                senhaNova:
                  type: string
      responses:
        '200':
          description: Senha alterada com sucesso
        '400':
          description: Erro na alteração da senha - campos faltando, nova senha muito curta ou nova senha igual à atual
        '401':
          description: Senha atual incorreta ou token inválido
        '404':
          description: Usuário não encontrado

  /api/clientes:
    get:
      summary: Lista todos os clientes
      tags: [Clientes]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de clientes retornada com sucesso
    post:
      summary: Cria um novo cliente (com endereço opcional)
      tags: [Clientes]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Cliente'
      responses:
        '201':
          description: Cliente criado com sucesso
        '400':
          description: Erro na criação do cliente

  /api/clientes/{id}:
    get:
      summary: Busca um cliente por ID
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Cliente encontrado
    put:
      summary: Atualiza os dados de um cliente
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Cliente'
      responses:
        '200':
          description: Cliente atualizado

    patch:
      summary: Atualiza parcialmente os dados de um cliente (por exemplo, email ou telefone)
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Cliente'
      responses:
        '200':
          description: Cliente atualizado parcialmente

    delete:
      summary: Exclui um cliente
      tags: [Clientes]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Cliente removido

  /api/advogados:
    get:
      summary: Lista todos os advogados
      tags: [Advogados]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de advogados
    post:
      summary: Cria um novo advogado
      tags: [Advogados]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Advogado'
      responses:
        '201':
          description: Advogado criado com sucesso
        '400':
          description: Erro na criação do advogado

  /api/advogados/{id}:
    get:
      summary: Busca advogado por ID
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Advogado encontrado

    put:
      summary: Atualiza um advogado
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:      
          application/json:
            schema:
              $ref: '#/components/schemas/Advogado'
      responses:
        '200':
          description: Advogado atualizado
        '400':
          description: Erro na atualização do advogado

    patch:
      summary: Atualiza parcialmente o advogado (por exemplo, status)
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Advogado'
      responses:
        '200':
          description: Advogado atualizado
    delete:
      summary: Remove um advogado
      tags: [Advogados]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Advogado excluído

  /api/enderecos:
    get:
      summary: Lista todos os endereços
      tags: [Endereços]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de endereços
    post:
      summary: Cria um novo endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Endereco'
      responses:
        '201':
          description: Endereço criado
        '400':
          description: Erro na criação do endereço

  /api/enderecos/{id}:
    get:
      summary: Busca um endereço por ID
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Endereço encontrado
        '404':
          description: Endereço não encontrado
    put:
      summary: Atualiza um endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Endereco'
      responses:
        '200':
          description: Endereço atualizado
        '400':
          description: Erro na atualização do endereço

    patch:
      summary: Atualiza parcialmente um endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Endereco'
      responses:
        '200':
          description: Endereço atualizado
        '400':
          description: Erro na atualização do endereço

    delete:
      summary: Exclui um endereço
      tags: [Endereços]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Endereço removido
        '400':
          description: Erro na remoção do endereço

  /api/processos:
    get:
      summary: Lista todos os processos
      tags: [Processos]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de processos
    post:
      summary: Cria um novo processo
      tags: [Processos]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Processo'
      responses:
        '201':
          description: Processo criado

  /api/processos/{id}:
    get:
      summary: Busca processo por ID
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '200':
          description: Processo encontrado
        '404':
          description: Processo não encontrado
    put:
      summary: Atualiza um processo
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Processo'
      responses:
        '200':
          description: Processo atualizado
    delete:
      summary: Exclui um processo
      tags: [Processos]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          schema:
            type: string
      responses:
        '204':
          description: Processo removido